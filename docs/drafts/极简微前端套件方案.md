# æç®€ç‰ˆå¾®å‰ç«¯å¥—ä»¶æ–¹æ¡ˆ

## ğŸš€ For Lovable - å¾®å‰ç«¯ Shell åº”ç”¨

````
è¯·ä¸ºæˆ‘åˆ›å»ºä¸€ä¸ªç§æœ‰éƒ¨ç½²çš„å¾®å‰ç«¯ Shell åº”ç”¨ï¼Œè¦æ±‚ï¼š

## æ ¸å¿ƒæ¶æ„
1. **å‰ç«¯æ¡†æ¶**ï¼šReact 18 + Vite + TypeScript
2. **åç«¯æ¡†æ¶**ï¼šExpress.js + TypeScriptï¼ˆè½»é‡çº§å®‰å…¨ä»£ç†ï¼Œæ— æ•°æ®åº“ï¼‰
3. **å¾®å‰ç«¯åŠ è½½**ï¼šæ”¯æŒ Module Federation 2.0 å’ŒåŸç”Ÿ JS ç»„ä»¶åŠ¨æ€æŒ‚è½½
4. **è®¤è¯æ–¹æ¡ˆ**ï¼šOAuth2 æˆæƒç æµç¨‹ï¼Œä¸ä½¿ç”¨ Supabase
5. **UIç»„ä»¶åº“**ï¼šshadcn/ui + Tailwind CSSï¼ˆç¾å¦†ä¸»é¢˜è‰²å½©ï¼‰

## è®¤è¯ä¸ä¼šè¯ç®¡ç†
1. **OAuth2 å®‰å…¨ä»£ç†å®ç°**ï¼š
   - Express.js åç«¯å¤„ç† OAuth2 æˆæƒç æµç¨‹
   - è·¯ç”±ï¼š`/auth/login`ã€`/auth/callback`ã€`/api/token/refresh`
   - å°† refresh_token å­˜å‚¨åœ¨ HttpOnly + Secure + SameSite=Strict çš„ Cookie ä¸­
   - æä¾› `/api/token/refresh` æ¥å£ä¾›å‰ç«¯è·å– access_token

2. **å®‰å…¨é…ç½®**ï¼š
   - æ‰€æœ‰æ•æ„Ÿé…ç½®é€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†ï¼ˆCLIENT_IDã€CLIENT_SECRETã€AUTH_SERVER_URLï¼‰
   - ä½¿ç”¨ helmet.js å¢å¼ºå®‰å…¨æ€§
   - å®ç° CSRF ä¿æŠ¤

## å‰ç«¯ Shell åŠŸèƒ½ï¼ˆç§»åŠ¨ç«¯ä¼˜å…ˆï¼‰
1. **ç°ä»£åŒ– UI è®¾è®¡**ï¼š
   - ç¾å¦†ä¸»é¢˜ï¼šä¸»è‰²#FF85A2ï¼ˆç²‰è‰²ï¼‰ï¼Œè¾…åŠ©è‰²#7BB5FFï¼ˆè“è‰²ï¼‰
   - ç§»åŠ¨ç«¯ï¼šåº•éƒ¨å¯¼èˆªæ ï¼ˆé¦–é¡µã€åº”ç”¨ã€é€šçŸ¥ã€æˆ‘çš„ï¼‰
   - æ¡Œé¢ç«¯ï¼šä¾§è¾¹æ  + ä¸»å†…å®¹åŒºåŸŸå¸ƒå±€
   - å“åº”å¼è®¾è®¡ï¼Œåœ†è§’è®¾è®¡ï¼Œå¾®å¦™é˜´å½±æ•ˆæœ
   - æ·±è‰²/æµ…è‰²ä¸»é¢˜åˆ‡æ¢

2. **å¾®å‰ç«¯åŠ è½½å™¨**ï¼š
   - æ”¯æŒä» `/config/micro-apps.json` åŠ¨æ€è¯»å–å­åº”ç”¨é…ç½®
   - å®ç° Module Federation è¿œç¨‹ç»„ä»¶åŠ è½½
   - æ”¯æŒåŸç”Ÿ JS ç»„ä»¶é€šè¿‡åŠ¨æ€å¯¼å…¥åŠ è½½
   - æ”¯æŒ iframe æ¨¡å¼ï¼ˆå…¼å®¹é—ç•™ç³»ç»Ÿï¼‰
   - æä¾›ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œå›é€€æœºåˆ¶

3. **è®¤è¯çŠ¶æ€ç®¡ç†**ï¼š
   - å®ç°å…¨å±€ `window.authManager` å¯¹è±¡
   - åœ¨ React Context ä¸­ç®¡ç† access_token çŠ¶æ€
   - æä¾›è‡ªåŠ¨åˆ·æ–°æœºåˆ¶ï¼ˆæ£€æµ‹ 401 é”™è¯¯æ—¶è‡ªåŠ¨åˆ·æ–°ï¼‰
   - ç»Ÿä¸€çš„ç™»å½•/ç™»å‡ºæµç¨‹

4. **æ ¸å¿ƒé¡µé¢ç»“æ„**ï¼š
   - ç™»å½•é¡µé¢ï¼ˆSMSéªŒè¯ç  + OAuth2é€‰é¡¹ï¼‰
   - é¦–é¡µï¼ˆæ¬¢è¿ç•Œé¢ + å¿«æ·å…¥å£ï¼‰
   - åº”ç”¨é¡µé¢ï¼ˆå¾®å‰ç«¯åº”ç”¨å¡ç‰‡å±•ç¤ºï¼‰
   - é€šçŸ¥é¡µé¢ï¼ˆæ¶ˆæ¯åˆ—è¡¨ï¼‰
   - ä¸ªäººä¸­å¿ƒï¼ˆç”¨æˆ·ä¿¡æ¯ + è®¾ç½®ï¼‰

## é¡¹ç›®ç»“æ„
```
micro-frontend-shell/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ shell-frontend/          # React å‰ç«¯
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ components/      # UIç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ hooks/           # è‡ªå®šä¹‰Hooks
â”‚   â”‚   â”‚   â”œâ”€â”€ contexts/        # React Context
â”‚   â”‚   â”‚   â””â”€â”€ utils/           # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â”‚   â””â”€â”€ webpack.config.js    # Module Federation
â”‚   â””â”€â”€ shell-backend/           # Express.js åç«¯
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ routes/          # OAuth2ä»£ç†è·¯ç”±
â”‚       â”‚   â”œâ”€â”€ middleware/      # å®‰å…¨ä¸­é—´ä»¶
â”‚       â”‚   â””â”€â”€ utils/           # è®¤è¯å·¥å…·
â”‚       â””â”€â”€ package.json
â”œâ”€â”€ config/
â”‚   â””â”€â”€ mf-manifest.json         # å¾®å‰ç«¯é…ç½®
â”œâ”€â”€ docker-compose.yml           # å®¹å™¨åŒ–éƒ¨ç½²
â”œâ”€â”€ .env.example                 # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ README.md
```

## å…³é”®ç‰¹æ€§
1. **ç§æœ‰éƒ¨ç½²ä¼˜å…ˆ**ï¼šæ‰€æœ‰é…ç½®æ”¯æŒç§æœ‰ç¯å¢ƒï¼Œæ— å¤–éƒ¨äº‘æœåŠ¡ä¾èµ–
2. **å®‰å…¨ç¬¬ä¸€**ï¼šclient_secret å®Œå…¨åç«¯åŒ–ï¼ŒHttpOnly Cookie ç®¡ç†
3. **ç§»åŠ¨ç«¯ä¼˜å…ˆ**ï¼šè§¦æ‘¸å‹å¥½è®¾è®¡ï¼Œæœ€å°44pxè§¦æ‘¸åŒºåŸŸ
4. **å¼€å‘ä½“éªŒ**ï¼šæ”¯æŒçƒ­é‡è½½ã€TypeScript ç±»å‹æ£€æŸ¥
5. **ç”Ÿäº§å°±ç»ª**ï¼šåŒ…å« Docker é…ç½®ã€ç¯å¢ƒå˜é‡ç®¡ç†
6. **æ‰©å±•æ€§**ï¼šæ”¯æŒå¤šç§å¾®å‰ç«¯æŠ€æœ¯æ ˆï¼ˆReactã€Vueã€åŸç”Ÿ JSï¼‰

## è¾“å‡ºè¦æ±‚
è¯·ç”Ÿæˆå®Œæ•´çš„é¡¹ç›®ï¼ŒåŒ…æ‹¬ï¼š
- å®Œæ•´çš„ React + TypeScript å‰ç«¯æºç ï¼ˆç§»åŠ¨ç«¯ä¼˜å…ˆè®¾è®¡ï¼‰
- Express.js + TypeScript å®‰å…¨ä»£ç†åç«¯æºç 
- Vite é…ç½®æ–‡ä»¶ï¼ˆå¼€å‘ç”¨ï¼‰
- Webpack é…ç½®æ–‡ä»¶ï¼ˆModule Federation 2.0ï¼‰
- package.json åŠå®Œæ•´ä¾èµ–é…ç½®
- Tailwind é…ç½®ï¼ˆåŒ…å«ç¾å¦†ä¸»é¢˜è‰²å½©ï¼‰
- Docker å®¹å™¨åŒ–é…ç½®
- ç¯å¢ƒå˜é‡é…ç½®ç¤ºä¾‹
- è¯¦ç»†çš„ README.md éƒ¨ç½²æŒ‡å—

æŠ€æœ¯æ ˆï¼šReact 18 + TypeScript + Vite + Express.js + Module Federation + shadcn/ui + Tailwind CSS

é‡è¦ï¼šä¸ä½¿ç”¨ä»»ä½•æ•°æ®åº“ï¼Œå®Œå…¨æ— çŠ¶æ€è®¾è®¡ï¼
````

### ğŸ’¡ è®¾è®¡è¯´æ˜ï¼šä¸ºä»€ä¹ˆè¿™ä¸ªæç¤ºè¯æ›´é€‚åˆæ‚¨çš„éœ€æ±‚

1. **æ˜ç¡®æ‹’ç» Supabase**ï¼šç›´æ¥æŒ‡å®šä½¿ç”¨ Express.js å®ç° OAuth2ï¼Œé¿å… Lovable é»˜è®¤æ¨è Supabaseï¼Œç¡®ä¿ä¸ç°æœ‰è®¤è¯ç³»ç»Ÿé›†æˆ

2. **å¼ºè°ƒç§æœ‰éƒ¨ç½²**ï¼šçªå‡ºæ‰€æœ‰é…ç½®éƒ½è¦æ”¯æŒç§æœ‰ç¯å¢ƒï¼Œæ— å¤–éƒ¨äº‘æœåŠ¡ä¾èµ–ï¼Œç¬¦åˆä¼ä¸šçº§å®‰å…¨è¦æ±‚

3. **è¯¦ç»†çš„è®¤è¯è§„èŒƒ**ï¼šæ˜ç¡®æŒ‡å®š HttpOnly Cookie å­˜å‚¨ refresh_token çš„å…·ä½“å®ç°ï¼Œä¸ç°æœ‰ auth server çš„å®‰å…¨æœºåˆ¶å®Œå…¨åŒ¹é…

4. **å¾®å‰ç«¯æ¶æ„æ¸…æ™°**ï¼šåŒæ—¶æ”¯æŒ Module Federation å’ŒåŸç”Ÿ JS ç»„ä»¶åŠ è½½ï¼Œç¡®ä¿æŠ€æœ¯æ ˆçš„çµæ´»æ€§å’Œæ‰©å±•æ€§

5. **ç§»åŠ¨ç«¯ä¼˜å…ˆè®¾è®¡**ï¼šå¼ºè°ƒç§»åŠ¨ç«¯ä½“éªŒå’Œç¾å¦†ä¸»é¢˜ï¼Œç¡®ä¿ Lovable ç”Ÿæˆç¬¦åˆå“ç‰Œé£æ ¼çš„ç°ä»£åŒ–ç•Œé¢

6. **ç”Ÿäº§å°±ç»ªé…ç½®**ï¼šåŒ…å« Dockerã€ç¯å¢ƒå˜é‡ã€å®‰å…¨é…ç½®ç­‰ç”Ÿäº§éƒ¨ç½²å¿…éœ€çš„è¦ç´ ï¼Œé¿å…åæœŸå¤§é‡ä¿®æ”¹

7. **å®Œæ•´é¡¹ç›®ç»“æ„**ï¼šè¦æ±‚è¾“å‡ºå®Œæ•´çš„ monorepo ç»“æ„ï¼Œä¾¿äºå›¢é˜Ÿåä½œå¼€å‘å’Œä»£ç ç®¡ç†

è¿™ä¸ªæç¤ºè¯åº”è¯¥èƒ½è®© Lovable ç”Ÿæˆä¸€ä¸ªç¬¦åˆæ‚¨éœ€æ±‚çš„ã€ç•Œé¢ç¾è§‚çš„ã€åŠŸèƒ½å®Œæ•´çš„å¾®å‰ç«¯ Shell åº”ç”¨åŸºç¡€æ¶æ„ã€‚ç”Ÿæˆåï¼Œæ‚¨å¯ä»¥ç›´æ¥éƒ¨ç½²æµ‹è¯•ï¼Œç„¶åæ¨é€åˆ° GitHub ç”¨ Cursor è¿›è¡Œè¿›ä¸€æ­¥çš„å®šåˆ¶å¼€å‘ã€‚

---

## ğŸ“‹ è¯¦ç»†æŠ€æœ¯è§„èŒƒï¼ˆä¾›å¼€å‘è€…å‚è€ƒï¼‰

### è¯¦ç»†ç‰ˆæç¤ºè¯ï¼šå¾®å‰ç«¯ Shell åº”ç”¨ + è½»é‡çº§å®‰å…¨ä»£ç†

````
è¯·ä¸ºæˆ‘åˆ›å»ºä¸€ä¸ªå¾®å‰ç«¯ Shell åº”ç”¨ï¼ŒåŒ…å«è½»é‡çº§å®‰å…¨ä»£ç†åç«¯ï¼Œè¦æ±‚ï¼š

## æ ¸å¿ƒæ¶æ„
1. **å‰ç«¯æ¡†æ¶**ï¼šReact 18 + Vite + TypeScript
2. **ä»£ç†åç«¯**ï¼šExpress.js + TypeScriptï¼ˆä»…ä½œå®‰å…¨ä»£ç†ï¼Œæ— æ•°æ®åº“ï¼Œæ— ä¸šåŠ¡é€»è¾‘ï¼‰
3. **å¾®å‰ç«¯åŠ è½½**ï¼šæ”¯æŒ Module Federation 2.0 å’ŒåŸç”Ÿ JS ç»„ä»¶åŠ¨æ€æŒ‚è½½
4. **ä¸šåŠ¡åç«¯**ï¼šä¸ç°æœ‰ OAuth2 è®¤è¯æœåŠ¡å™¨é›†æˆï¼ˆæ‰€æœ‰ä¸šåŠ¡é€»è¾‘éƒ½åœ¨ç°æœ‰ç³»ç»Ÿï¼‰

## è½»é‡çº§ä»£ç†åç«¯èŒè´£ï¼ˆExpress.jsï¼‰
1. **å¤šç§è®¤è¯æ–¹æ¡ˆæ”¯æŒï¼ˆå®Œå…¨é€‚é…ç°æœ‰ auth serverï¼‰**ï¼š
   
   **æ–¹æ¡ˆ Aï¼šæ ‡å‡† OAuth2 æˆæƒç æµç¨‹**
   - Shell æä¾›ç™»å½•è·³è½¬ï¼š`/auth/login` â†’ é‡å®šå‘åˆ°è®¤è¯æœåŠ¡å™¨ `/oauth2/authorize`
   - è®¤è¯æœåŠ¡å™¨å›è°ƒï¼š`/auth/callback` â†’ æ¥æ”¶æˆæƒç å¹¶è°ƒç”¨ `/oauth2/token` æ¢å– token
   - å‰ç«¯æ— éœ€ç™»å½•è¡¨å•ï¼Œé€šè¿‡è·³è½¬å®Œæˆè®¤è¯
   
   **æ–¹æ¡ˆ Bï¼šSMS éªŒè¯ç è®¤è¯æµç¨‹ï¼ˆä¸»æ¨ï¼Œå®Œå…¨åŒ¹é…ç°æœ‰ç³»ç»Ÿï¼‰**
   - å‘é€éªŒè¯ç ï¼š`/auth/send-code` â†’ ä»£ç†åˆ° `/sms/send-code`
   - SMS ç™»å½•ï¼š`/auth/sms-login` â†’ ä»£ç†åˆ° `/sms/login`ï¼ˆGET æ–¹æ³•ï¼ŒæŸ¥è¯¢å‚æ•°æ ¼å¼ï¼‰
   - å®Œå…¨å…¼å®¹ç°æœ‰çš„ Cookie å®‰å…¨æ¨¡å¼
   - æ”¯æŒç°æœ‰çš„å‚æ•°æ ¼å¼ï¼šmobileNumber, verificationCode, clientId
   
   **æ–¹æ¡ˆ Cï¼šä»£ç†è®¤è¯æµç¨‹ï¼ˆéœ€åŒåŸŸéƒ¨ç½²ï¼‰**
   - Shell ä»£ç†è®¤è¯æ¥å£ï¼šé€‚ç”¨äºéœ€è¦ç»Ÿä¸€ç”¨æˆ·ä½“éªŒçš„åœºæ™¯
   - è¦æ±‚ Shell å’Œè®¤è¯æœåŠ¡å™¨åŒåŸŸéƒ¨ç½²
   
   **é€šç”¨ Token ç®¡ç†**ï¼š
   - Token åˆ·æ–°ï¼š`/api/token/refresh` â†’ ä»£ç†åˆ° `/sms/refresh-token`
   - å®Œå…¨æ”¯æŒç°æœ‰çš„ HttpOnly Cookie æ¨¡å¼
   - è‡ªåŠ¨å¤„ç† client_secretï¼Œå‰ç«¯é›¶æš´éœ²

2. **å®‰å…¨çš„ Cookie ç®¡ç†ï¼ˆå®Œå…¨å…¼å®¹ç°æœ‰ç³»ç»Ÿï¼‰**ï¼š
   - è®¾ç½® HttpOnly + Secure + SameSite=Strict Cookie
   - è‡ªåŠ¨ç®¡ç† refresh_token çš„å­˜å‚¨å’Œè½®æ¢
   - æ”¯æŒç°æœ‰ç³»ç»Ÿçš„ Cookie é…ç½®å’ŒåŸŸåç­–ç•¥
   - ä¿æŒä¸ç°æœ‰è®¤è¯ç³»ç»Ÿçš„ä¼šè¯ä¸€è‡´æ€§

3. **é™æ€èµ„æºæœåŠ¡**ï¼š
   - æœåŠ¡å‰ç«¯é™æ€æ–‡ä»¶
   - é…ç½®å¾®å‰ç«¯åº”ç”¨çš„è·¯ç”±è§„åˆ™
   - å¤„ç† SPA è·¯ç”±å›é€€ï¼ˆhistoryApiFallbackï¼‰

4. **ç¯å¢ƒé…ç½®**ï¼š
   - é€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†æ‰€æœ‰é…ç½®ï¼ˆCLIENT_IDã€CLIENT_SECRETã€AUTH_SERVER_URLï¼‰
   - æ”¯æŒå¼€å‘/ç”Ÿäº§ç¯å¢ƒåˆ‡æ¢
   - æ— ä»»ä½•ç¡¬ç¼–ç é…ç½®

5. **æ˜ç¡®é™åˆ¶**ï¼š
   - âŒ ä¸ä½¿ç”¨æ•°æ®åº“ï¼ˆå®Œå…¨æ— çŠ¶æ€ï¼‰
   - âŒ ä¸åŒ…å«ä»»ä½•ä¸šåŠ¡é€»è¾‘
   - âŒ ä¸å­˜å‚¨ç”¨æˆ·æ•°æ®
   - âœ… ä»…ä½œä¸ºå®‰å…¨ä»£ç†å’Œé™æ€èµ„æºæœåŠ¡å™¨
   - âœ… å®Œå…¨ä¾èµ–ç°æœ‰ auth server çš„æ‰€æœ‰è®¤è¯å’Œä¸šåŠ¡åŠŸèƒ½

## å‰ç«¯ Shell åŠŸèƒ½
1. **ç§»åŠ¨ç«¯ä¼˜å…ˆçš„ç°ä»£åŒ– UI è®¾è®¡ï¼ˆåŸºäºæˆç†Ÿçš„è®¾è®¡ç³»ç»Ÿï¼‰**ï¼š
   - **ç»„ä»¶åº“**ï¼šä½¿ç”¨ shadcn/ui ç»„ä»¶åº“ï¼Œç¡®ä¿ç°ä»£åŒ–å’Œä¸€è‡´æ€§
   - **è®¾è®¡å“²å­¦**ï¼šç§»åŠ¨ç«¯ä¼˜å…ˆï¼ˆMobile Firstï¼‰ï¼Œç®€æ´ã€å¹²å‡€ã€ç°ä»£åŒ–å¤–è§‚
   - **å¸ƒå±€é£æ ¼**ï¼šå¡ç‰‡å¼å¸ƒå±€ï¼ˆCard-basedï¼‰ä¸ºä¸»ï¼Œå†…å®¹åŒºåŸŸåˆ’åˆ†æ¸…æ™°
   - **è§†è§‰ç‰¹å¾**ï¼š
     - ç»„ä»¶æ™®éä½¿ç”¨åœ†è§’ï¼ˆé»˜è®¤ `0.5rem`ï¼‰ï¼Œè¥é€ æŸ”å’Œã€äº²åˆ‡çš„è§†è§‰æ„Ÿå—
     - ä½¿ç”¨å¾®å¦™çš„é˜´å½±æ•ˆæœï¼ˆ`sm` å’Œ `md`ï¼‰å¢åŠ ç»„ä»¶å±‚æ¬¡æ„Ÿ
     - è§¦æ‘¸ä¼˜å…ˆçš„äº¤äº’è®¾è®¡ï¼ŒæŒ‰é’®å’Œç‚¹å‡»åŒºåŸŸä¸å°äº 44px

2. **å“ç‰ŒåŒ–è‰²å½©ç³»ç»Ÿ**ï¼š
   - **åŸºç¡€é¢œè‰²**ï¼šåŸºäº shadcn/ui çš„ neutral ä¸»é¢˜
   - **å“ç‰Œè‡ªå®šä¹‰é¢œè‰²**ï¼š
     ```css
     --beauty-pink: #FF85A2        /* ä¸»è‰²è°ƒï¼Œå…³é”®æ“ä½œå’Œå“ç‰Œå…ƒç´  */
     --beauty-blue: #7BB5FF        /* è¾…åŠ©è‰²ï¼Œä¿¡æ¯çŠ¶æ€æˆ–æ¬¡è¦äº¤äº’ */
     --beauty-pink-light: #FFECF2  /* ç²‰è‰²æµ…è‰²ç‰ˆï¼ŒèƒŒæ™¯æˆ–é«˜äº®åŒºåŸŸ */
     --beauty-blue-light: #EDF5FF  /* è“è‰²æµ…è‰²ç‰ˆï¼ŒèƒŒæ™¯ç”¨é€” */
     --beauty-gray: #F0F2F5        /* ä¸­æ€§ç°ï¼ŒèƒŒæ™¯ã€åˆ†éš”çº¿ */
     --beauty-yellow: #FFF9E6      /* æç¤ºä¿¡æ¯èƒŒæ™¯è‰² */
     --beauty-pink-active: #FF4785 /* æ‚¬åœæˆ–æ¿€æ´»çŠ¶æ€å¼ºè°ƒè‰² */
     ```
   - **ä¸»é¢˜åˆ‡æ¢**ï¼šæ”¯æŒæ·±è‰²/æµ…è‰²ä¸»é¢˜åˆ‡æ¢ï¼Œä½¿ç”¨ CSS å˜é‡å®ç°
   - **è‰²å½©åº”ç”¨**ï¼šä¸»è¦æ“ä½œæŒ‰é’®ä½¿ç”¨ beauty-pinkï¼Œä¿¡æ¯æç¤ºä½¿ç”¨ beauty-blue

3. **ç§»åŠ¨ç«¯ä¼˜å…ˆçš„å“åº”å¼å¸ƒå±€**ï¼š
   - **æ‰‹æœºç«¯ï¼ˆ<768pxï¼‰**ï¼š
     - å•åˆ—å¸ƒå±€ï¼Œå…¨å®½æ˜¾ç¤º
     - åº•éƒ¨å¯¼èˆªæ ï¼ˆTab Barï¼‰ä»£æ›¿ä¾§è¾¹æ 
     - é¡¶éƒ¨å›ºå®šå¯¼èˆªæ ï¼ŒåŒ…å«ï¼šæ±‰å ¡èœå• + æ ‡é¢˜ + ç”¨æˆ·å¤´åƒ
     - ä¸»å†…å®¹åŒºå æ»¡å±å¹•ï¼Œæ”¯æŒå‚ç›´æ»šåŠ¨
     - æµ®åŠ¨æ“ä½œæŒ‰é’®ï¼ˆFABï¼‰ç”¨äºå¿«é€Ÿæ“ä½œ
   - **å¹³æ¿ç«¯ï¼ˆ768px-1024pxï¼‰**ï¼š
     - å¯é€‰çš„ä¾§è¾¹æ æŠ½å±‰ï¼Œé»˜è®¤éšè—
     - é¡¶éƒ¨å¯¼èˆªæ  + ä¸»å†…å®¹åŒºå¸ƒå±€
     - æ”¯æŒæ¨ªå±æ—¶çš„åˆ†æ æ˜¾ç¤º
   - **æ¡Œé¢ç«¯ï¼ˆ>1024pxï¼‰**ï¼š
     - ç»å…¸çš„ä¾§è¾¹æ  + ä¸»å†…å®¹åŒºå¸ƒå±€
     - ä¾§è¾¹æ é»˜è®¤å±•å¼€ä¸”å›ºå®š

4. **ç§»åŠ¨ç«¯ä¼˜åŒ–çš„å¯¼èˆªç³»ç»Ÿ**ï¼š
   - **åº•éƒ¨å¯¼èˆªæ ï¼ˆæ‰‹æœºç«¯ä¸»å¯¼èˆªï¼‰**ï¼š
     ```jsx
     // åº•éƒ¨å¯¼èˆªé¡¹ç›®ç¤ºä¾‹
     [
       { icon: "Home", label: "é¦–é¡µ", route: "/" },
       { icon: "Grid3X3", label: "åº”ç”¨", route: "/apps" },
       { icon: "Bell", label: "é€šçŸ¥", route: "/notifications" },
       { icon: "User", label: "æˆ‘çš„", route: "/profile" }
     ]
     ```
   - **é¡¶éƒ¨å¯¼èˆªæ **ï¼š
     - å·¦ä¾§ï¼šæ±‰å ¡èœå•ï¼ˆæ‰‹æœºç«¯ï¼‰æˆ– Logoï¼ˆæ¡Œé¢ç«¯ï¼‰
     - ä¸­é—´ï¼šå½“å‰é¡µé¢æ ‡é¢˜æˆ–é¢åŒ…å±‘
     - å³ä¾§ï¼šä¸»é¢˜åˆ‡æ¢ + é€šçŸ¥ + ç”¨æˆ·èœå•
   - **ä¾§è¾¹æ æŠ½å±‰ï¼ˆå¹³æ¿/æ¡Œé¢ï¼‰**ï¼š
     - å¾®å‰ç«¯åº”ç”¨åˆ—è¡¨ï¼Œå¡ç‰‡å¼è®¾è®¡
     - æ”¯æŒåˆ†ç»„å’Œæœç´¢
     - ä½¿ç”¨ Lucide React å›¾æ ‡åº“çš„ç°ä»£åŒ–çº¿æ€§å›¾æ ‡

5. **æ™ºèƒ½å¾®å‰ç«¯åŠ è½½å™¨ï¼ˆç§»åŠ¨ç«¯ä¼˜åŒ–ï¼‰**ï¼š
   - ä» `/config/micro-apps.json` åŠ¨æ€è¯»å–åº”ç”¨é…ç½®
   - æ”¯æŒå¤šç§åŠ è½½æ–¹å¼ï¼š
     - Module Federation 2.0 è¿œç¨‹ç»„ä»¶
     - åŸç”Ÿ ES6 æ¨¡å—åŠ¨æ€å¯¼å…¥
     - iframe æ¨¡å¼ï¼ˆå…¼å®¹é—ç•™ç³»ç»Ÿï¼Œæ”¯æŒç§»åŠ¨ç«¯é€‚é…ï¼‰
   - ç§»åŠ¨ç«¯ç‰¹æ®Šä¼˜åŒ–ï¼š
     - æ‡’åŠ è½½å’Œé¢„åŠ è½½ç­–ç•¥
     - è§¦æ‘¸å‹å¥½çš„åŠ è½½çŠ¶æ€æŒ‡ç¤ºå™¨
     - ç½‘ç»œçŠ¶æ€æ„ŸçŸ¥ï¼ˆæ˜¾ç¤ºç¦»çº¿/åœ¨çº¿çŠ¶æ€ï¼‰
   - ç»Ÿä¸€çš„é”™è¯¯å¤„ç†ã€loading çŠ¶æ€ã€å›é€€æœºåˆ¶
   - åº”ç”¨é—´é€šä¿¡ï¼šå…¨å±€äº‹ä»¶æ€»çº¿ + çŠ¶æ€å…±äº«

6. **è®¤è¯çŠ¶æ€ç®¡ç†ï¼ˆå¤šç§è®¤è¯æ–¹æ¡ˆæ”¯æŒï¼‰**ï¼š
   - React Context + useAuth Hook ç®¡ç†ç™»å½•çŠ¶æ€
   - å…¨å±€ `window.authManager` å¯¹è±¡ä¾›å¾®å‰ç«¯ä½¿ç”¨
   - è‡ªåŠ¨ token åˆ·æ–°ï¼ˆ401 é”™è¯¯æ£€æµ‹ï¼‰
   - æ”¯æŒå¤šç§è®¤è¯æµç¨‹ï¼ˆè§ä¸‹æ–¹è¯¦ç»†è¯´æ˜ï¼‰

7. **ç§»åŠ¨ç«¯äº¤äº’ä½“éªŒå¢å¼º**ï¼š
   - **è§¦æ‘¸ä¼˜åŒ–**ï¼š
     - æ‰€æœ‰å¯ç‚¹å‡»å…ƒç´ æœ€å°å°ºå¯¸ 44pxÃ—44px
     - æ”¯æŒè§¦æ‘¸åé¦ˆï¼ˆè§†è§‰å’Œè§¦è§‰ï¼‰
     - é˜²æ­¢æ„å¤–ç‚¹å‡»çš„é€‚å½“é—´è·
   - **æ‰‹åŠ¿æ”¯æŒ**ï¼š
     - ä¾§æ»‘è¿”å›ï¼ˆiOSé£æ ¼ï¼‰
     - ä¸‹æ‹‰åˆ·æ–°
     - ä¸Šæ»‘åŠ è½½æ›´å¤š
   - **åŠ¨ç”»æ•ˆæœ**ï¼šä½¿ç”¨ tailwindcss-animateï¼Œé’ˆå¯¹ç§»åŠ¨ç«¯ä¼˜åŒ–
     - é¡µé¢è½¬åœºï¼šæ»‘åŠ¨åŠ¨ç”»ï¼ˆslide-in/slide-outï¼‰
     - åº•éƒ¨å¯¼èˆªåˆ‡æ¢ï¼šæ·¡å…¥æ·¡å‡º + å›¾æ ‡åŠ¨ç”»
     - åŠ è½½çŠ¶æ€ï¼šé€‚åˆå°å±å¹•çš„éª¨æ¶å±
   - **æ€§èƒ½ä¼˜åŒ–**ï¼š
     - è™šæ‹Ÿæ»šåŠ¨ï¼ˆé•¿åˆ—è¡¨ï¼‰
     - å›¾ç‰‡æ‡’åŠ è½½
     - ä»£ç åˆ†å‰²å’ŒæŒ‰éœ€åŠ è½½

## ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æµè§ˆå™¨ (Browser)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¾®å‰ç«¯ Shell åº”ç”¨ (React + Module Federation)             â”‚
â”‚  â”œâ”€â”€ ä¸»æ¡†æ¶ (Layout + è·¯ç”±)                                 â”‚
â”‚  â”œâ”€â”€ å¾®åº”ç”¨1 (Module Federation)                           â”‚
â”‚  â”œâ”€â”€ å¾®åº”ç”¨2 (ES6 Module)                                  â”‚
â”‚  â””â”€â”€ å¾®åº”ç”¨3 (iframe)                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ HTTPè¯·æ±‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Express.js å®‰å…¨ä»£ç† (æ— çŠ¶æ€)                      â”‚
â”‚  â”œâ”€â”€ OAuth2 ä»£ç† (/auth/*)                                 â”‚
â”‚  â”œâ”€â”€ Token åˆ·æ–°ä»£ç† (/api/token/refresh)                   â”‚
â”‚  â”œâ”€â”€ é™æ€èµ„æºæœåŠ¡ (/, /static/*)                           â”‚
â”‚  â””â”€â”€ å¾®å‰ç«¯é…ç½® (/config/*)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ ä»£ç†è½¬å‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ç°æœ‰ OAuth2 è®¤è¯æœåŠ¡å™¨                         â”‚
â”‚  â”œâ”€â”€ ç”¨æˆ·ç™»å½• (/oauth2/token)                              â”‚
â”‚  â”œâ”€â”€ Tokenåˆ·æ–° (/oauth2/token)                             â”‚
â”‚  â”œâ”€â”€ ç”¨æˆ·ä¿¡æ¯ (/api/user/profile)                          â”‚
â”‚  â”œâ”€â”€ æƒé™ç®¡ç† (/api/auth/*)                                â”‚
â”‚  â””â”€â”€ æ‰€æœ‰ä¸šåŠ¡API                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## é¡¹ç›®ç»“æ„

```
micro-frontend-shell/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ shell-frontend/                    # React å‰ç«¯
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Layout/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ MainContent.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MicroFrontend/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MicroFrontendLoader.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ModuleFederationLoader.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ES6ModuleLoader.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ IframeLoader.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Auth/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LoginButton.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UserMenu.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AuthGuard.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Theme/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ ThemeToggle.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ useMicroApp.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ useTheme.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ contexts/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AuthContext.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ThemeContext.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ authManager.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ eventBus.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ microAppLoader.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ App.tsx
â”‚   â”‚   â”‚   â””â”€â”€ main.tsx
â”‚   â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â”‚   â””â”€â”€ webpack.config.js              # Module Federation
â”‚   â””â”€â”€ shell-backend/                     # Express.js å®‰å…¨ä»£ç†
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ routes/
â”‚       â”‚   â”‚   â”œâ”€â”€ auth.ts               # OAuth2 ä»£ç†è·¯ç”±
â”‚       â”‚   â”‚   â”œâ”€â”€ api.ts                # API ä»£ç†è·¯ç”±
â”‚       â”‚   â”‚   â””â”€â”€ static.ts             # é™æ€èµ„æºè·¯ç”±
â”‚       â”‚   â”œâ”€â”€ middleware/
â”‚       â”‚   â”‚   â”œâ”€â”€ security.ts           # å®‰å…¨ä¸­é—´ä»¶
â”‚       â”‚   â”‚   â”œâ”€â”€ cors.ts               # CORS é…ç½®
â”‚       â”‚   â”‚   â””â”€â”€ proxy.ts              # ä»£ç†ä¸­é—´ä»¶
â”‚       â”‚   â”œâ”€â”€ utils/
â”‚       â”‚   â”‚   â”œâ”€â”€ oauth2Client.ts       # OAuth2 å®¢æˆ·ç«¯
â”‚       â”‚   â”‚   â””â”€â”€ config.ts             # é…ç½®ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ app.ts
â”‚       â”‚   â””â”€â”€ server.ts
â”‚       â”œâ”€â”€ package.json
â”‚       â””â”€â”€ tsconfig.json
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ micro-apps.json                   # å¾®å‰ç«¯åº”ç”¨é…ç½®
â”‚   â””â”€â”€ environments/
â”‚       â”œâ”€â”€ development.env
â”‚       â””â”€â”€ production.env
â”œâ”€â”€ docker-compose.yml                    # å®¹å™¨åŒ–éƒ¨ç½²
â”œâ”€â”€ .env.example                          # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ README.md
â””â”€â”€ package.json                          # æ ¹çº§ workspace ç®¡ç†
```

## å…³é”®é…ç½®ç¤ºä¾‹

### 1. Express.js ä»£ç†åç«¯æ ¸å¿ƒè·¯ç”±

```javascript
// routes/auth.ts - å¤šç§è®¤è¯æ–¹æ¡ˆå®ç°

// ===== æ–¹æ¡ˆ Aï¼šæ ‡å‡† OAuth2 æˆæƒç æµç¨‹ =====
// 1. å‘èµ·ç™»å½• - é‡å®šå‘åˆ°è®¤è¯æœåŠ¡å™¨
app.get('/auth/login', (req, res) => {
  const state = generateRandomString(); // CSRF ä¿æŠ¤
  const authUrl = new URL(`${AUTH_SERVER_URL}/oauth2/authorize`);
  
  authUrl.searchParams.set('response_type', 'code');
  authUrl.searchParams.set('client_id', process.env.CLIENT_ID);
  authUrl.searchParams.set('redirect_uri', `${req.protocol}://${req.get('host')}/auth/callback`);
  authUrl.searchParams.set('scope', 'read write');
  authUrl.searchParams.set('state', state);
  
  // ä¿å­˜ state ç”¨äºéªŒè¯ï¼ˆå¯ä½¿ç”¨ session æˆ–ä¸´æ—¶å­˜å‚¨ï¼‰
  res.cookie('oauth_state', state, { 
    httpOnly: true, 
    maxAge: 10 * 60 * 1000, // 10åˆ†é’Ÿ
    sameSite: 'lax' 
  });
  
  res.redirect(authUrl.toString());
});

// 2. å¤„ç†è®¤è¯æœåŠ¡å™¨å›è°ƒ
app.get('/auth/callback', async (req, res) => {
  const { code, state } = req.query;
  const savedState = req.cookies.oauth_state;
  
  // éªŒè¯ state å‚æ•°ï¼ˆCSRF ä¿æŠ¤ï¼‰
  if (!state || state !== savedState) {
    return res.status(400).json({ error: 'Invalid state parameter' });
  }
  
  try {
    // ç”¨æˆæƒç æ¢å– token
    const response = await fetch(`${AUTH_SERVER_URL}/oauth2/token`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
      },
      body: new URLSearchParams({
        grant_type: 'authorization_code',
        code: code,
        client_id: process.env.CLIENT_ID,
        client_secret: process.env.CLIENT_SECRET, // ğŸ”’ å®‰å…¨ç®¡ç†
        redirect_uri: `${req.protocol}://${req.get('host')}/auth/callback`
      })
    });
    
    if (!response.ok) {
      throw new Error('Token exchange failed');
    }
    
    const data = await response.json();
    
    // è®¾ç½®å®‰å…¨çš„ HttpOnly Cookie
    res.cookie('refresh_token', data.refresh_token, {
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production',
      sameSite: 'strict',
      maxAge: 30 * 24 * 60 * 60 * 1000 // 30å¤©
    });
    
    // æ¸…é™¤ä¸´æ—¶ state cookie
    res.clearCookie('oauth_state');
    
    // é‡å®šå‘åˆ°å‰ç«¯åº”ç”¨ï¼Œæºå¸¦ access_token
    const redirectUrl = new URL('/dashboard', `${req.protocol}://${req.get('host')}`);
    redirectUrl.searchParams.set('access_token', data.access_token);
    redirectUrl.searchParams.set('expires_in', data.expires_in);
    
    res.redirect(redirectUrl.toString());
    
  } catch (error) {
    console.error('OAuth callback error:', error);
    res.redirect('/login?error=auth_failed');
  }
});

// ===== æ–¹æ¡ˆ Bï¼šä»£ç†è®¤è¯æµç¨‹ï¼ˆåŒåŸŸéƒ¨ç½²ï¼‰=====
app.post('/auth/proxy-login', async (req, res) => {
  try {
    // ä»£ç†ç™»å½•è¯·æ±‚åˆ°è®¤è¯æœåŠ¡å™¨ï¼ˆéœ€è¦åŒåŸŸéƒ¨ç½²ï¼‰
    const response = await fetch(`${AUTH_SERVER_URL}/api/auth/login`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-Forwarded-For': req.ip,
        'X-Forwarded-Host': req.get('host')
      },
      body: JSON.stringify({
        ...req.body,
        client_id: process.env.CLIENT_ID,
        client_secret: process.env.CLIENT_SECRET // ğŸ”’ å‰ç«¯æ°¸ä¸çŸ¥é“
      })
    });
    
    const data = await response.json();
    
    if (response.ok && data.access_token) {
      // è®¾ç½® HttpOnly Cookie
      res.cookie('refresh_token', data.refresh_token, {
        httpOnly: true,
        secure: process.env.NODE_ENV === 'production',
        sameSite: 'strict',
        maxAge: 30 * 24 * 60 * 60 * 1000
      });
      
      // åªè¿”å› access_token ç»™å‰ç«¯
      res.json({
        access_token: data.access_token,
        token_type: data.token_type,
        expires_in: data.expires_in,
        user_info: data.user_info
      });
    } else {
      res.status(response.status).json(data);
    }
  } catch (error) {
    console.error('Proxy login error:', error);
    res.status(500).json({ error: 'Internal server error' });
  }
});

// ===== æ–¹æ¡ˆ Cï¼šSMS éªŒè¯ç è®¤è¯æµç¨‹ï¼ˆé€‚é…ç°æœ‰ auth serverï¼‰=====
// å‘é€éªŒè¯ç  - åŒ¹é…ç°æœ‰ç«¯ç‚¹
app.post('/auth/send-code', async (req, res) => {
  try {
    // ä»£ç†åˆ°ç°æœ‰ auth server çš„ /sms/send-code ç«¯ç‚¹
    const response = await fetch(`${AUTH_SERVER_URL}/sms/send-code`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        phoneNumber: req.body.phoneNumber
      })
    });
    
    const data = await response.json();
    res.status(response.status).json(data);
  } catch (error) {
    console.error('Send code error:', error);
    res.status(500).json({ error: 'Failed to send verification code' });
  }
});

// SMS éªŒè¯ç ç™»å½• - åŒ¹é…ç°æœ‰ç«¯ç‚¹æ ¼å¼
app.get('/auth/sms-login', async (req, res) => {
  try {
    const { mobileNumber, verificationCode } = req.query;
    
    // ä»£ç†åˆ°ç°æœ‰ auth server çš„ /sms/login ç«¯ç‚¹ï¼ˆGET æ–¹æ³•ï¼‰
    const loginUrl = new URL(`${AUTH_SERVER_URL}/sms/login`);
    loginUrl.searchParams.set('mobileNumber', mobileNumber);
    loginUrl.searchParams.set('verificationCode', verificationCode);
    loginUrl.searchParams.set('clientId', process.env.CLIENT_ID);
    
    const response = await fetch(loginUrl.toString(), {
      method: 'GET',
      credentials: 'include' // æ”¯æŒ cookie æ¨¡å¼
    });
    
    if (response.ok) {
      const data = await response.json();
      
      // è®¾ç½® HttpOnly Cookieï¼ˆå¦‚æœè¿”å›äº† refresh_tokenï¼‰
      if (data.refresh_token) {
        res.cookie('refresh_token', data.refresh_token, {
          httpOnly: true,
          secure: process.env.NODE_ENV === 'production',
          sameSite: 'strict',
          maxAge: 30 * 24 * 60 * 60 * 1000
        });
      }
      
      // è¿”å› access_token å’Œç”¨æˆ·ä¿¡æ¯ç»™å‰ç«¯
      res.json({
        access_token: data.access_token,
        token_type: data.token_type || 'Bearer',
        expires_in: data.expires_in,
        user_info: {
          mobileNumber: mobileNumber,
          loginTime: new Date().toISOString()
        }
      });
    } else {
      const errorData = await response.json();
      res.status(response.status).json(errorData);
    }
  } catch (error) {
    console.error('SMS login error:', error);
    res.status(500).json({ error: 'SMS login failed' });
  }
});

// ===== é€šç”¨ï¼šToken åˆ·æ–°ï¼ˆåŒ¹é…ç°æœ‰ç«¯ç‚¹ï¼‰=====
app.post('/api/token/refresh', async (req, res) => {
  const refreshToken = req.cookies.refresh_token;
  
  if (!refreshToken) {
    return res.status(401).json({ error: 'No refresh token available' });
  }
  
  try {
    // ä»£ç†åˆ°ç°æœ‰ auth server çš„ /sms/refresh-token ç«¯ç‚¹
    const response = await fetch(`${AUTH_SERVER_URL}/sms/refresh-token`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
      },
      credentials: 'include', // Cookie æ¨¡å¼æ”¯æŒ
      body: new URLSearchParams({
        grant_type: 'refresh_token',
        client_id: process.env.CLIENT_ID
        // æ³¨æ„ï¼šCookie æ¨¡å¼ä¸‹ refresh_token å’Œ client_secret ç”±æœåŠ¡å™¨è‡ªåŠ¨å¤„ç†
      })
    });
    
    if (!response.ok) {
      res.clearCookie('refresh_token');
      const errorData = await response.json();
      return res.status(response.status).json(errorData);
    }
    
    const data = await response.json();
    
    // æ›´æ–° refresh_token cookieï¼ˆå¦‚æœè¿”å›äº†æ–°çš„ï¼‰
    if (data.refresh_token) {
      res.cookie('refresh_token', data.refresh_token, {
        httpOnly: true,
        secure: process.env.NODE_ENV === 'production',
        sameSite: 'strict',
        maxAge: 30 * 24 * 60 * 60 * 1000
      });
    }
    
    res.json({
      access_token: data.access_token,
      token_type: data.token_type || 'Bearer',
      expires_in: data.expires_in
    });
  } catch (error) {
    console.error('Token refresh error:', error);
    res.status(500).json({ error: 'Internal server error' });
  }
});

// ç™»å‡º
app.post('/auth/logout', (req, res) => {
  res.clearCookie('refresh_token');
  res.json({ message: 'Logged out successfully' });
});

// ä¸šåŠ¡APIä»£ç† - è‡ªåŠ¨é™„åŠ Authorizationå¤´
app.use('/api/business/*', async (req, res) => {
  const authHeader = req.headers.authorization;
  
  if (!authHeader) {
    return res.status(401).json({ error: 'No authorization header' });
  }
  
  try {
    const response = await fetch(`${AUTH_SERVER_URL}${req.path}`, {
      method: req.method,
      headers: {
        ...req.headers,
        'Authorization': authHeader,
        'Host': undefined // ç§»é™¤Hostå¤´é¿å…å†²çª
      },
      body: req.method !== 'GET' ? JSON.stringify(req.body) : undefined
    });
    
    const data = await response.json();
    res.status(response.status).json(data);
  } catch (error) {
    console.error('API proxy error:', error);
    res.status(500).json({ error: 'Proxy request failed' });
  }
});
```

### 2. å¾®å‰ç«¯åº”ç”¨é…ç½®

```json
// config/micro-apps.json
{
  "apps": [
    {
      "id": "user-management",
      "name": "ç”¨æˆ·ç®¡ç†",
      "type": "module-federation",
      "url": "http://localhost:3001/remoteEntry.js",
      "scope": "userManagement",
      "module": "./UserApp",
      "icon": "Users",
      "iconColor": "beauty-blue",
      "route": "/users",
      "permissions": ["admin"],
      "description": "ç®¡ç†ç³»ç»Ÿç”¨æˆ·å’Œæƒé™"
    },
    {
      "id": "dashboard",
      "name": "æ•°æ®çœ‹æ¿",
      "type": "es6-module",
      "url": "http://localhost:3002/dashboard.js",
      "icon": "BarChart3",
      "iconColor": "beauty-pink",
      "route": "/dashboard",
      "permissions": [],
      "description": "å®æ—¶æ•°æ®åˆ†æå’Œå¯è§†åŒ–"
    },
    {
      "id": "legacy-system",
      "name": "é—ç•™ç³»ç»Ÿ",
      "type": "iframe",
      "url": "http://localhost:3003/legacy",
      "icon": "Archive",
      "iconColor": "beauty-gray",
      "route": "/legacy",
      "permissions": ["user"],
      "description": "ç°æœ‰ä¸šåŠ¡ç³»ç»Ÿé›†æˆ"
    }
  ],
  "theme": {
    "primaryColor": "beauty-pink",
    "secondaryColor": "beauty-blue",
    "layout": "sidebar-left"
  }
}
```

### 3. Tailwind CSS é…ç½®ï¼ˆç§»åŠ¨ç«¯ä¼˜å…ˆ + å“ç‰ŒåŒ–ä¸»é¢˜ï¼‰

```javascript
// packages/shell-frontend/tailwind.config.js
const { fontFamily } = require("tailwindcss/defaultTheme")

/** @type {import('tailwindcss').Config} */
module.exports = {
  darkMode: ["class"],
  content: [
    './pages/**/*.{ts,tsx}',
    './components/**/*.{ts,tsx}',
    './app/**/*.{ts,tsx}',
    './src/**/*.{ts,tsx}',
  ],
  theme: {
    container: {
      center: true,
      padding: "1rem", // ç§»åŠ¨ç«¯å‹å¥½çš„å†…è¾¹è·
      screens: {
        "sm": "640px",
        "md": "768px", 
        "lg": "1024px",
        "xl": "1280px",
        "2xl": "1400px",
      },
    },
    extend: {
      colors: {
        border: "hsl(var(--border))",
        input: "hsl(var(--input))",
        ring: "hsl(var(--ring))",
        background: "hsl(var(--background))",
        foreground: "hsl(var(--foreground))",
        primary: {
          DEFAULT: "hsl(var(--primary))",
          foreground: "hsl(var(--primary-foreground))",
        },
        secondary: {
          DEFAULT: "hsl(var(--secondary))",
          foreground: "hsl(var(--secondary-foreground))",
        },
        destructive: {
          DEFAULT: "hsl(var(--destructive))",
          foreground: "hsl(var(--destructive-foreground))",
        },
        muted: {
          DEFAULT: "hsl(var(--muted))",
          foreground: "hsl(var(--muted-foreground))",
        },
        accent: {
          DEFAULT: "hsl(var(--accent))",
          foreground: "hsl(var(--accent-foreground))",
        },
        popover: {
          DEFAULT: "hsl(var(--popover))",
          foreground: "hsl(var(--popover-foreground))",
        },
        card: {
          DEFAULT: "hsl(var(--card))",
          foreground: "hsl(var(--card-foreground))",
        },
        // å“ç‰Œè‡ªå®šä¹‰é¢œè‰²
        'beauty-pink': {
          DEFAULT: '#FF85A2',
          light: '#FFECF2',
          active: '#FF4785',
          50: '#FFF5F7',
          100: '#FFECF2',
          500: '#FF85A2',
          600: '#FF4785',
          700: '#E63570',
        },
        'beauty-blue': {
          DEFAULT: '#7BB5FF',
          light: '#EDF5FF',
          50: '#F0F8FF',
          100: '#EDF5FF',
          500: '#7BB5FF',
          600: '#5B9CFF',
          700: '#3B82F6',
        },
        'beauty-gray': {
          DEFAULT: '#F0F2F5',
          50: '#F9FAFB',
          100: '#F0F2F5',
          200: '#E5E7EB',
          500: '#9CA3AF',
          700: '#374151',
        },
        'beauty-yellow': '#FFF9E6',
      },
      borderRadius: {
        lg: "var(--radius)", // 0.5rem
        md: "calc(var(--radius) - 2px)",
        sm: "calc(var(--radius) - 4px)",
      },
      fontFamily: {
        sans: ["var(--font-sans)", ...fontFamily.sans],
      },
      // ç§»åŠ¨ç«¯ä¸“ç”¨é—´è·
      spacing: {
        'safe-top': 'env(safe-area-inset-top)',
        'safe-bottom': 'env(safe-area-inset-bottom)',
        'safe-left': 'env(safe-area-inset-left)',
        'safe-right': 'env(safe-area-inset-right)',
        '18': '4.5rem', // 72px - é€‚åˆè§¦æ‘¸åŒºåŸŸ
        '22': '5.5rem', // 88px - å¤§å‹è§¦æ‘¸æŒ‰é’®
      },
      // ç§»åŠ¨ç«¯å‹å¥½çš„æœ€å°å°ºå¯¸
      minHeight: {
        'touch': '44px', // iOS æœ€å°è§¦æ‘¸åŒºåŸŸ
        'screen-safe': 'calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom))',
      },
      minWidth: {
        'touch': '44px',
      },
      keyframes: {
        "accordion-down": {
          from: { height: 0 },
          to: { height: "var(--radix-accordion-content-height)" },
        },
        "accordion-up": {
          from: { height: "var(--radix-accordion-content-height)" },
          to: { height: 0 },
        },
        "slide-up": {
          from: { transform: "translateY(100%)" },
          to: { transform: "translateY(0)" },
        },
        "slide-down": {
          from: { transform: "translateY(-100%)" },
          to: { transform: "translateY(0)" },
        },
        "slide-in-right": {
          from: { transform: "translateX(100%)" },
          to: { transform: "translateX(0)" },
        },
        "slide-in-left": {
          from: { transform: "translateX(-100%)" },
          to: { transform: "translateX(0)" },
        },
        "fade-in": {
          from: { opacity: 0 },
          to: { opacity: 1 },
        },
        "bounce-in": {
          "0%": { transform: "scale(0.3)", opacity: 0 },
          "50%": { transform: "scale(1.05)", opacity: 0.8 },
          "70%": { transform: "scale(0.9)", opacity: 0.9 },
          "100%": { transform: "scale(1)", opacity: 1 },
        },
      },
      animation: {
        "accordion-down": "accordion-down 0.2s ease-out",
        "accordion-up": "accordion-up 0.2s ease-out",
        "slide-up": "slide-up 0.3s ease-out",
        "slide-down": "slide-down 0.3s ease-out",
        "slide-in-right": "slide-in-right 0.3s ease-out",
        "slide-in-left": "slide-in-left 0.3s ease-out",
        "fade-in": "fade-in 0.2s ease-out",
        "bounce-in": "bounce-in 0.5s ease-out",
      },
    },
  },
  plugins: [
    require("tailwindcss-animate"),
    // ç§»åŠ¨ç«¯è§¦æ‘¸ä¼˜åŒ–æ’ä»¶
    function({ addUtilities }) {
      addUtilities({
        '.touch-manipulation': {
          'touch-action': 'manipulation',
        },
        '.scroll-smooth': {
          'scroll-behavior': 'smooth',
        },
        // iOS æ ·å¼çš„å¡ç‰‡é˜´å½±
        '.shadow-ios': {
          'box-shadow': '0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24)',
        },
        '.shadow-ios-lg': {
          'box-shadow': '0 4px 8px rgba(0, 0, 0, 0.12), 0 2px 4px rgba(0, 0, 0, 0.08)',
        },
      })
    }
  ],
}
```

### 4. CSS å˜é‡å®šä¹‰ï¼ˆç§»åŠ¨ç«¯ä¼˜åŒ– + å…¨å±€æ ·å¼ï¼‰

```css
/* packages/shell-frontend/src/globals.css */
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
    --primary: 222.2 47.4% 11.2%;
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96%;
    --secondary-foreground: 222.2 47.4% 11.2%;
    --muted: 210 40% 96%;
    --muted-foreground: 215.4 16.3% 46.9%;
    --accent: 210 40% 96%;
    --accent-foreground: 222.2 47.4% 11.2%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 222.2 84% 4.9%;
    --radius: 0.5rem;
    
    /* å“ç‰Œè‡ªå®šä¹‰é¢œè‰² CSS å˜é‡ */
    --beauty-pink: 345 100% 76%;
    --beauty-blue: 218 100% 74%;
    --beauty-pink-light: 345 100% 96%;
    --beauty-blue-light: 218 100% 96%;
    --beauty-gray: 210 17% 94%;
    --beauty-yellow: 48 100% 96%;
    --beauty-pink-active: 345 100% 64%;
  }

  .dark {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;
    --primary: 210 40% 98%;
    --primary-foreground: 222.2 47.4% 11.2%;
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 212.7 26.8% 83.9%;
    
    /* æ·±è‰²æ¨¡å¼ä¸‹çš„å“ç‰Œè‰²è°ƒæ•´ */
    --beauty-pink: 345 85% 70%;
    --beauty-blue: 218 85% 70%;
    --beauty-pink-light: 345 50% 15%;
    --beauty-blue-light: 218 50% 15%;
    --beauty-gray: 217 15% 20%;
    --beauty-yellow: 48 50% 15%;
    --beauty-pink-active: 345 90% 65%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  
  html {
    /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
    -webkit-text-size-adjust: 100%;
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
  }
  
  body {
    @apply bg-background text-foreground;
    /* iOS å®‰å…¨åŒºåŸŸé€‚é… */
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
    /* é˜²æ­¢æ©¡çš®ç­‹æ•ˆæœ */
    overscroll-behavior: none;
  }
  
  /* ç§»åŠ¨ç«¯æ»šåŠ¨æ¡ä¼˜åŒ– */
  ::-webkit-scrollbar {
    width: 4px;
    height: 4px;
  }
  
  ::-webkit-scrollbar-track {
    @apply bg-beauty-gray/30;
  }
  
  ::-webkit-scrollbar-thumb {
    @apply bg-beauty-pink/60 rounded-full;
  }
  
  ::-webkit-scrollbar-thumb:hover {
    @apply bg-beauty-pink-active/80;
  }
  
  /* ç§»åŠ¨ç«¯è¡¨å•å…ƒç´ ä¼˜åŒ– */
  input, textarea, select {
    @apply text-base; /* é˜²æ­¢ iOS ç¼©æ”¾ */
  }
  
  /* ç¦ç”¨ç§»åŠ¨ç«¯é•¿æŒ‰é€‰æ‹© */
  .no-select {
    -webkit-user-select: none;
    user-select: none;
  }
}

@layer components {
  /* ç§»åŠ¨ç«¯ä¼˜åŒ–çš„æŒ‰é’®æ ·å¼ */
  .btn-beauty-primary {
    @apply bg-beauty-pink hover:bg-beauty-pink-active active:bg-beauty-pink-active text-white font-medium py-3 px-6 rounded-lg transition-all duration-200 min-h-touch min-w-touch touch-manipulation shadow-ios active:shadow-ios-lg;
  }
  
  .btn-beauty-secondary {
    @apply bg-beauty-blue hover:bg-beauty-blue/80 active:bg-beauty-blue/70 text-white font-medium py-3 px-6 rounded-lg transition-all duration-200 min-h-touch min-w-touch touch-manipulation shadow-ios;
  }
  
  /* ç§»åŠ¨ç«¯ä¼˜åŒ–çš„å¡ç‰‡æ ·å¼ */
  .card-beauty {
    @apply bg-card border border-border rounded-lg shadow-ios hover:shadow-ios-lg transition-all duration-300 touch-manipulation;
  }
  
  /* åº•éƒ¨å¯¼èˆªæ æ ·å¼ */
  .bottom-nav {
    @apply fixed bottom-0 left-0 right-0 bg-card border-t border-border z-50;
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  .bottom-nav-item {
    @apply flex flex-col items-center justify-center py-2 px-1 min-h-touch transition-colors duration-200 touch-manipulation;
  }
  
  .bottom-nav-item.active {
    @apply text-beauty-pink;
  }
  
  .bottom-nav-item:not(.active) {
    @apply text-muted-foreground hover:text-foreground;
  }
  
  /* é¡¶éƒ¨å¯¼èˆªæ æ ·å¼ */
  .top-nav {
    @apply sticky top-0 z-40 w-full bg-card/80 backdrop-blur-sm border-b border-border;
    padding-top: env(safe-area-inset-top);
  }
  
  /* ä¾§è¾¹æ èœå•é¡¹æ ·å¼ï¼ˆç§»åŠ¨ç«¯é€‚é…ï¼‰ */
  .sidebar-item {
    @apply flex items-center gap-3 px-4 py-4 mx-2 rounded-lg transition-all duration-200 hover:bg-beauty-pink-light hover:text-beauty-pink-active cursor-pointer min-h-touch touch-manipulation;
  }
  
  .sidebar-item.active {
    @apply bg-beauty-pink text-white shadow-ios;
  }
  
  /* æµ®åŠ¨æ“ä½œæŒ‰é’® */
  .fab {
    @apply fixed bottom-20 right-4 w-14 h-14 bg-beauty-pink hover:bg-beauty-pink-active text-white rounded-full shadow-ios-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center z-40 touch-manipulation;
    margin-bottom: env(safe-area-inset-bottom);
  }
  
  /* æŠ½å±‰/æ¨¡æ€æ¡†æ ·å¼ */
  .drawer {
    @apply fixed inset-0 z-50 bg-black/50 backdrop-blur-sm;
  }
  
  .drawer-content {
    @apply fixed bottom-0 left-0 right-0 bg-card rounded-t-2xl max-h-[90vh] overflow-y-auto;
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  /* è§¦æ‘¸åé¦ˆåŠ¨ç”» */
  .touch-feedback {
    @apply active:scale-95 transition-transform duration-100;
  }
}

/* ç§»åŠ¨ç«¯ç‰¹å®šåª’ä½“æŸ¥è¯¢ */
@media (max-width: 767px) {
  .desktop-only {
    display: none !important;
  }
}

@media (min-width: 768px) {
  .mobile-only {
    display: none !important;
  }
}

/* iOS PWA æ”¯æŒ */
@media (display-mode: standalone) {
  body {
    /* PWA æ¨¡å¼ä¸‹çš„é¢å¤–æ ·å¼ */
    --safe-area-inset-top: env(safe-area-inset-top);
  }
}
```

### 5. è¾…åŠ©å‡½æ•°ï¼ˆè®¤è¯ç›¸å…³ï¼‰

```javascript
// packages/shell-backend/src/utils/auth.js

// ç”Ÿæˆéšæœºå­—ç¬¦ä¸²ï¼ˆç”¨äº OAuth2 state å‚æ•°ï¼‰
function generateRandomString(length = 32) {
  const charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
  let result = '';
  const randomValues = new Uint8Array(length);
  
  if (typeof crypto !== 'undefined' && crypto.getRandomValues) {
    crypto.getRandomValues(randomValues);
  } else {
    // Node.js ç¯å¢ƒå›é€€æ–¹æ¡ˆ
    const cryptoNode = require('crypto');
    for (let i = 0; i < length; i++) {
      randomValues[i] = Math.floor(Math.random() * 256);
    }
  }
  
  for (let i = 0; i < length; i++) {
    result += charset[randomValues[i] % charset.length];
  }
  
  return result;
}

// éªŒè¯ JWT tokenï¼ˆå¯é€‰ï¼‰
function verifyJWT(token, secret) {
  try {
    const jwt = require('jsonwebtoken');
    return jwt.verify(token, secret);
  } catch (error) {
    return null;
  }
}

// Cookie é…ç½®ç”Ÿæˆå™¨
function getCookieConfig(isProduction = false) {
  return {
    httpOnly: true,
    secure: isProduction,
    sameSite: 'strict',
    maxAge: 30 * 24 * 60 * 60 * 1000, // 30å¤©
  };
}

module.exports = {
  generateRandomString,
  verifyJWT,
  getCookieConfig
};
```

### 3. ç¯å¢ƒå˜é‡é…ç½®

```bash
# .env.example
NODE_ENV=development
PORT=3000

# OAuth2 é…ç½®
CLIENT_ID=your-client-id
CLIENT_SECRET=your-client-secret
AUTH_SERVER_URL=http://localhost:8080

# CORS é…ç½®
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# Cookie é…ç½®
COOKIE_SECRET=your-random-secret-for-cookie-signing
COOKIE_DOMAIN=localhost

# å¾®å‰ç«¯é…ç½®
MICRO_APPS_CONFIG_URL=/config/micro-apps.json
```

## å…³é”®ç‰¹æ€§
1. **å®‰å…¨ç¬¬ä¸€**ï¼šclient_secret å®Œå…¨åç«¯åŒ–ï¼Œå‰ç«¯é›¶æš´éœ²
2. **æ— çŠ¶æ€è®¾è®¡**ï¼šExpress.js åç«¯å®Œå…¨æ— çŠ¶æ€ï¼Œå¯æ°´å¹³æ‰©å±•
3. **ä¸šåŠ¡åˆ†ç¦»**ï¼šæ‰€æœ‰ä¸šåŠ¡é€»è¾‘éƒ½åœ¨ç°æœ‰OAuth2æœåŠ¡å™¨ï¼Œé¿å…é‡å¤
4. **å¼€å‘ä½“éªŒ**ï¼šæ”¯æŒçƒ­é‡è½½ã€TypeScriptã€ç°ä»£å·¥å…·é“¾
5. **ç”Ÿäº§å°±ç»ª**ï¼šåŒ…å« Dockerã€ç¯å¢ƒå˜é‡ã€å®‰å…¨é…ç½®

## å¼€å‘ä¸éƒ¨ç½²

### å¼€å‘æ¨¡å¼
```bash
# 1. å¯åŠ¨ç°æœ‰çš„OAuth2è®¤è¯æœåŠ¡å™¨ï¼ˆå‡è®¾è¿è¡Œåœ¨8080ç«¯å£ï¼‰
# ï¼ˆè¿™éƒ¨åˆ†ç”±ç°æœ‰ç³»ç»Ÿæä¾›ï¼‰

# 2. å¯åŠ¨ Shell åç«¯ï¼ˆå®‰å…¨ä»£ç†ï¼‰
cd micro-frontend-shell/packages/shell-backend
npm install
npm run dev  # è¿è¡Œåœ¨3000ç«¯å£

# 3. å¯åŠ¨ Shell å‰ç«¯ï¼ˆå¼€å‘æœåŠ¡å™¨ï¼‰
cd ../shell-frontend
npm install
npm run dev  # è¿è¡Œåœ¨5173ç«¯å£

# 4. è®¿é—®åº”ç”¨
open http://localhost:3000  # ç”Ÿäº§æ¨¡å¼
# æˆ–
open http://localhost:5173  # å¼€å‘æ¨¡å¼ï¼ˆä¼šä»£ç†åˆ°3000ç«¯å£çš„åç«¯ï¼‰
```

### ç”Ÿäº§éƒ¨ç½²
```bash
# ä½¿ç”¨ Docker Compose ä¸€é”®éƒ¨ç½²
docker-compose up -d

# æˆ–æ‰‹åŠ¨æ„å»ºéƒ¨ç½²
cd micro-frontend-shell
npm run build
npm start
```

## ä¸ç°æœ‰è®¤è¯ç³»ç»Ÿçš„é›†æˆç‚¹

1. **è®¤è¯é›†æˆï¼ˆå®Œå…¨é€‚é…ç°æœ‰ auth serverï¼‰**ï¼š
   - **æ ‡å‡† OAuth2 æµç¨‹**ï¼š`/oauth2/authorize` å’Œ `/oauth2/token`ï¼ˆå¦‚æœæ”¯æŒï¼‰
   - **SMS éªŒè¯ç ç™»å½•**ï¼š
     - å‘é€éªŒè¯ç ï¼š`/sms/send-code`ï¼ˆPOSTï¼ŒJSONæ ¼å¼ï¼‰
     - SMS ç™»å½•ï¼š`/sms/login`ï¼ˆGETï¼ŒæŸ¥è¯¢å‚æ•°ï¼šmobileNumber, verificationCode, clientIdï¼‰
   - **Token åˆ·æ–°**ï¼š`/sms/refresh-token`ï¼ˆPOSTï¼Œæ”¯æŒ Cookie æ¨¡å¼ï¼‰
   - **HttpOnly Cookie æ”¯æŒ**ï¼šå®Œå…¨å…¼å®¹ç°æœ‰çš„ Cookie å®‰å…¨æ¨¡å¼

2. **APIè½¬å‘**ï¼š
   - æ‰€æœ‰ä¸šåŠ¡APIè¯·æ±‚è½¬å‘åˆ°ç°æœ‰è®¤è¯æœåŠ¡å™¨
   - è‡ªåŠ¨é™„åŠ  Authorization header
   - ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
   - æ”¯æŒç°æœ‰çš„æƒé™éªŒè¯æœºåˆ¶

3. **é…ç½®åŒæ­¥**ï¼š
   - å¾®å‰ç«¯åº”ç”¨æƒé™é…ç½®ä¸ç°æœ‰æƒé™ç³»ç»Ÿå¯¹æ¥
   - æ”¯æŒåŠ¨æ€æƒé™æ£€æŸ¥å’Œèœå•æ˜¾ç¤º
   - ç”¨æˆ·è§’è‰²å’Œæƒé™å®æ—¶åŒæ­¥
   - å®Œå…¨å¤ç”¨ç°æœ‰çš„ç”¨æˆ·ç®¡ç†å’Œæƒé™ä½“ç³»

4. **å®‰å…¨ç‰¹æ€§ç»§æ‰¿**ï¼š
   - ç»§æ‰¿ç°æœ‰çš„ client_secret ç®¡ç†
   - å¤ç”¨ç°æœ‰çš„ HttpOnly Cookie å®‰å…¨æœºåˆ¶
   - æ”¯æŒç°æœ‰çš„ CORS å’Œå®‰å…¨é…ç½®
   - ä¿æŒä¸ç°æœ‰ç³»ç»Ÿçš„ä¼šè¯ä¸€è‡´æ€§

## è¾“å‡ºè¦æ±‚
è¯·ç”Ÿæˆå®Œæ•´çš„é¡¹ç›®ï¼ŒåŒ…æ‹¬ï¼š

### å‰ç«¯éƒ¨åˆ†ï¼ˆåŸºäºæˆç†Ÿè®¾è®¡ç³»ç»Ÿï¼‰
- **å®Œæ•´çš„ React + TypeScript æºç **ï¼š
  - ä½¿ç”¨ shadcn/ui ç»„ä»¶åº“ï¼Œç¡®ä¿ç°ä»£åŒ–å’Œä¸€è‡´æ€§
  - é›†æˆ Lucide React å›¾æ ‡åº“
  - å®ç°å“ç‰ŒåŒ–çš„ç¾å¦†ä¸»é¢˜è‰²å½©ç³»ç»Ÿ
  - å¡ç‰‡å¼å¸ƒå±€è®¾è®¡ï¼Œåœ†è§’å’Œå¾®å¦™é˜´å½±æ•ˆæœ
  - å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒæ·±è‰²/æµ…è‰²ä¸»é¢˜åˆ‡æ¢

- **å®Œæ•´çš„ä¾èµ–é…ç½®**ï¼š
  ```json
  {
    "dependencies": {
      "react": "^18.0.0",
      "react-dom": "^18.0.0",
      "next": "^14.0.0",
      "@radix-ui/react-accordion": "^1.1.2",
      "@radix-ui/react-avatar": "^1.0.4",
      "@radix-ui/react-dialog": "^1.0.5",
      "@radix-ui/react-dropdown-menu": "^2.0.6",
      "@radix-ui/react-navigation-menu": "^1.1.4",
      "@radix-ui/react-popover": "^1.0.7",
      "@radix-ui/react-select": "^2.0.0",
      "@radix-ui/react-separator": "^1.0.3",
      "@radix-ui/react-slot": "^1.0.2",
      "@radix-ui/react-switch": "^1.0.3",
      "@radix-ui/react-tabs": "^1.0.4",
      "@radix-ui/react-toast": "^1.1.5",
      "lucide-react": "^0.294.0",
      "class-variance-authority": "^0.7.0",
      "clsx": "^2.0.0",
      "tailwind-merge": "^2.0.0"
    }
  }
  ```

- **Vite é…ç½®æ–‡ä»¶**ï¼š
  - æ”¯æŒå¼€å‘çƒ­é‡è½½å’ŒTypeScript
  - Module Federation 2.0 é›†æˆé…ç½®
  - è·¯å¾„åˆ«åé…ç½®ï¼ˆ@/components, @/utils ç­‰ï¼‰

- **Webpack é…ç½®æ–‡ä»¶**ï¼š
  - Module Federation 2.0 å®Œæ•´é…ç½®
  - æ”¯æŒè¿œç¨‹ç»„ä»¶åŠ è½½å’Œå…±äº«ä¾èµ–

### åç«¯éƒ¨åˆ†ï¼ˆè½»é‡çº§å®‰å…¨ä»£ç†ï¼‰
- **Express.js + TypeScript å®Œæ•´æºç **ï¼š
  - OAuth2 ä»£ç†è·¯ç”±ï¼ˆå®Œæ•´çš„æˆæƒç æµç¨‹å’Œtokenåˆ·æ–°ï¼‰
  - å®‰å…¨çš„ HttpOnly Cookie ç®¡ç†
  - ä¸šåŠ¡APIä»£ç†è½¬å‘
  - CORS å’Œå®‰å…¨ä¸­é—´ä»¶

- **å®Œæ•´çš„ä¾èµ–é…ç½®**ï¼š
  ```json
  {
    "dependencies": {
      "express": "^4.18.0",
      "cookie-parser": "^1.4.6",
      "cors": "^2.8.5",
      "helmet": "^7.0.0",
      "dotenv": "^16.0.0",
      "node-fetch": "^3.3.0"
    },
    "devDependencies": {
      "@types/express": "^4.17.0",
      "@types/cookie-parser": "^1.4.0",
      "@types/cors": "^2.8.0",
      "typescript": "^5.0.0",
      "ts-node": "^10.9.0",
      "nodemon": "^3.0.0"
    }
  }
  ```

### é…ç½®æ–‡ä»¶å®Œæ•´é›†åˆ
- **Tailwind CSS é…ç½®**ï¼šåŒ…å«å“ç‰Œè‰²å½©ç³»ç»Ÿã€è‡ªå®šä¹‰åŠ¨ç”»ã€shadcn/ui é›†æˆ
- **å…¨å±€ CSS æ ·å¼**ï¼šCSS å˜é‡å®šä¹‰ã€æ·±è‰²æ¨¡å¼æ”¯æŒã€å“ç‰ŒåŒ–ç»„ä»¶æ ·å¼
- **TypeScript é…ç½®**ï¼šä¸¥æ ¼æ¨¡å¼ã€è·¯å¾„æ˜ å°„ã€æ¨¡å—è§£æ
- **ESLint å’Œ Prettier é…ç½®**ï¼šä»£ç è´¨é‡å’Œæ ¼å¼åŒ–è§„èŒƒ

### å®¹å™¨åŒ–ä¸éƒ¨ç½²
- **Docker é…ç½®**ï¼š
  - å¤šé˜¶æ®µæ„å»ºé…ç½®ï¼ˆå¼€å‘å’Œç”Ÿäº§ç¯å¢ƒï¼‰
  - docker-compose.yml ä¸€é”®éƒ¨ç½²
  - ç¯å¢ƒå˜é‡ç®¡ç†å’Œå®‰å…¨é…ç½®

- **ç¯å¢ƒå˜é‡ç¤ºä¾‹**ï¼š
  - å¼€å‘ç¯å¢ƒé…ç½®ï¼ˆ.env.developmentï¼‰
  - ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼ˆ.env.productionï¼‰
  - å®‰å…¨å»ºè®®å’Œæœ€ä½³å®è·µ

### å¼€å‘å·¥å…·ä¸æŒ‡å—
- **è¯¦ç»†çš„å¼€å‘æŒ‡å—**ï¼š
  - æœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»º
  - å¾®å‰ç«¯åº”ç”¨æ¥å…¥æµç¨‹
  - ä¸»é¢˜å®šåˆ¶å’Œå“ç‰ŒåŒ–æŒ‡å—
  - ç»„ä»¶å¼€å‘è§„èŒƒ

- **éƒ¨ç½²æŒ‡å—**ï¼š
  - Docker éƒ¨ç½²æµç¨‹
  - ç¯å¢ƒå˜é‡é…ç½®
  - åå‘ä»£ç†é…ç½®ç¤ºä¾‹ï¼ˆNginxï¼‰
  - ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–å»ºè®®

### ç¤ºä¾‹å’Œæ–‡æ¡£
- **å¾®å‰ç«¯åº”ç”¨ç¤ºä¾‹**ï¼šè‡³å°‘åŒ…å«ä¸€ä¸ª Module Federation è¿œç¨‹åº”ç”¨ç¤ºä¾‹
- **API é›†æˆç¤ºä¾‹**ï¼šOAuth2 æµç¨‹å®Œæ•´æ¼”ç¤º
- **ä¸»é¢˜åˆ‡æ¢ç¤ºä¾‹**ï¼šæ·±è‰²/æµ…è‰²æ¨¡å¼å®ç°
- **README.md**ï¼šå®Œæ•´çš„é¡¹ç›®ä»‹ç»ã€å¿«é€Ÿå¼€å§‹ã€API æ–‡æ¡£

æŠ€æœ¯æ ˆï¼šReact 18 + TypeScript + Vite + Express.js + Module Federation + shadcn/ui + Tailwind CSS
````


<div style="text-align: center">â‚</div>

[^1]: https://github.com/krzemienski/awesome-from-stars

[^2]: http://152.67.113.27/articles/Claude+Task+Master+(MCP)+:+AIé©±åŠ¨å¼€å‘çš„æ–°èŒƒå¼ä¸AIç¼–è¾‘å™¨é›†æˆå®æˆ˜_12469712_csdn.html

[^3]: https://blog.csdn.net/weixin_51798265/article/details/149032682

[^4]: https://wangchujiang.com/github-rank/repos.html

[^5]: https://m.douyin.com/zhuanti/7497460006347868171

[^6]: https://segmentfault.com/a/1190000045448357

[^7]: https://yanggggjie.github.io/rising-repo/

[^8]: https://emp2.netlify.app

[^9]: https://github.com/viktorbezdek/awesome-github-projects

[^10]: https://module-federation.io/zh/

[^11]: https://www.reddit.com/r/nextjs/comments/1d2wl4r/how_do_i_create_a_react_library_with_server_and/?tl=zh-hans

[^12]: https://rspack.webpack.js.cn/guide/features/module-federation

[^13]: https://steamcommunity.com/sharedfiles/filedetails/?l=english\&id=2670001474

[^14]: https://module-federation.io/zh/practice/frameworks/react/i18n-react

[^15]: https://www.cnblogs.com/S031602219/p/15726636.html

[^16]: https://blog.csdn.net/mmc123125/article/details/144962456

[^17]: https://jackchoumine.github.io/webpack/æ¨¡å—è”é‚¦å®ç°å¾®å‰ç«¯.html

[^18]: https://www.reddit.com/r/reactjs/comments/1f4hika/microfrontend_experiences/?tl=zh-hans

[^19]: https://juejin.cn/post/7493389842505678883

[^20]: https://blog.csdn.net/weixin_46247794/article/details/147282556

[^21]: https://www.infoq.cn/article/xkgdacfbls3qoafpqahb

[^22]: https://www.jianshu.com/p/83b0f6d82d6c

[^23]: https://github.com/yuzhanglong/mf-lite

[^24]: https://www.53ai.com/news/LargeLanguageModel/2025052861853.html

[^25]: https://blog.csdn.net/snsHL9db69ccu1aIKl9r/article/details/121199893

[^26]: https://everfind.github.io/courses/webpack/micro-frontend.html

[^27]: https://www.53ai.com/news/LargeLanguageModel/2025071020318.html

[^28]: https://my.oschina.net/emacs_8678152/blog/16967270

[^29]: https://juejin.cn/post/7509354376990621715

[^30]: https://www.cnblogs.com/LexLuc/p/18665033

[^31]: https://tenten.co/learning/openai-codex-guide/

[^32]: https://www.cnblogs.com/vipzhou/p/8125924.html

[^33]: https://www.51cto.com/article/818551.html

[^34]: https://blog.csdn.net/beidouapp/article/details/80871733

[^35]: https://github.com/aben1188/my-star-repos

[^36]: https://blog.csdn.net/weixin_30471065/article/details/95377901

[^37]: https://github.com/wuwenjie1992/StarryDivineSky


